<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="my writeups for osu!gaming CTF 2024"><title>osu!gaming CTF 2024</title><link rel=canonical href=https://www.catgirl.ing/p/osugamingctf-2024/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="osu!gaming CTF 2024"><meta property="og:description" content="my writeups for osu!gaming CTF 2024"><meta property="og:url" content="https://www.catgirl.ing/p/osugamingctf-2024/"><meta property="og:site_name" content="Rose's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2024-03-05T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-05T00:00:00+00:00"><meta property="og:image" content="https://www.catgirl.ing/p/osugamingctf-2024/osu-gaming-ctf-2024-1.png"><meta name=twitter:title content="osu!gaming CTF 2024"><meta name=twitter:description content="my writeups for osu!gaming CTF 2024"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.catgirl.ing/p/osugamingctf-2024/osu-gaming-ctf-2024-1.png"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hue30bb870beaa9d46dab5f0d2db7cd0f0_188083_300x0_resize_box_3.png width=300 height=292 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Rose's Blog</a></h1><h2 class=site-description>Rose's Blog</h2></div></header><ol class=social-menu><li><a href=https://github.com/nancyjlau target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/unrelated333 target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg><span>About Me</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#blockchainscorechain>blockchain/scorechain</a></li><li><a href=#reversesat-before-osu>reverse/SAT-before-osu</a></li><li><a href=#cryptobase727>crypto/base727</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/osugamingctf-2024/><img src=/p/osugamingctf-2024/osu-gaming-ctf-2024-1_hu2f51bce6e33c2d3a3ffc9b2b5f5be3c5_1291290_800x0_resize_box_3.png srcset="/p/osugamingctf-2024/osu-gaming-ctf-2024-1_hu2f51bce6e33c2d3a3ffc9b2b5f5be3c5_1291290_800x0_resize_box_3.png 800w, /p/osugamingctf-2024/osu-gaming-ctf-2024-1_hu2f51bce6e33c2d3a3ffc9b2b5f5be3c5_1291290_1600x0_resize_box_3.png 1600w" width=800 height=204 loading=lazy alt="Featured image of post osu!gaming CTF 2024"></a></div><div class=article-details><header class=article-category><a href=/categories/ctf/ style=background-color:#2a9d8f;color:#fff>ctf</a>
<a href=/categories/competitions/ style=background-color:#569aee;color:#fff>competitions</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/osugamingctf-2024/>osu!gaming CTF 2024</a></h2><h3 class=article-subtitle>my writeups for osu!gaming CTF 2024</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Mar 05, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>9 minute read</time></div></footer></div></header><section class=article-content><p>These are my writeups for <a class=link href=https://ctftime.org/event/2165 target=_blank rel=noopener>osu!gaming CTF 2024</a>.</p><h3 id=blockchainscorechain>blockchain/scorechain</h3><blockquote><p>Snipe mr nathan on osu and claim the bounty in the very secure blockchain bancho!<br><code>nc chal2.osugaming.lol 8000</code><br>— <cite>Triacontakai</cite></p></blockquote><p>This problem was my first time working with blockchain problems. I was provided the file <a class=link href=dist.zip>dist.zip</a>, where it was a Rust Solana blockchain problem.</p><p>Initially looking at the <a class=link href=dist.zip>dist.zip</a>, this is the directory of the challenge</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>(</span>base<span class=o>)</span> rose@catputer scorechain % tree .
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── README.md
</span></span><span class=line><span class=cl>├── framework
</span></span><span class=line><span class=cl>│   ├── Cargo.lock
</span></span><span class=line><span class=cl>│   ├── Cargo.toml
</span></span><span class=line><span class=cl>│   ├── Dockerfile
</span></span><span class=line><span class=cl>│   ├── build_challenge.sh
</span></span><span class=line><span class=cl>│   ├── chall
</span></span><span class=line><span class=cl>│   │   ├── Anchor.toml
</span></span><span class=line><span class=cl>│   │   ├── Cargo.lock
</span></span><span class=line><span class=cl>│   │   ├── Cargo.toml
</span></span><span class=line><span class=cl>│   │   ├── migrations
</span></span><span class=line><span class=cl>│   │   │   └── deploy.ts
</span></span><span class=line><span class=cl>│   │   ├── package.json
</span></span><span class=line><span class=cl>│   │   ├── programs
</span></span><span class=line><span class=cl>│   │   │   └── chall
</span></span><span class=line><span class=cl>│   │   │       ├── Cargo.toml
</span></span><span class=line><span class=cl>│   │   │       ├── Xargo.toml
</span></span><span class=line><span class=cl>│   │   │       └── src
</span></span><span class=line><span class=cl>│   │   │           └── lib.rs
</span></span><span class=line><span class=cl>│   │   ├── tests
</span></span><span class=line><span class=cl>│   │   │   └── chall.ts
</span></span><span class=line><span class=cl>│   │   ├── tsconfig.json
</span></span><span class=line><span class=cl>│   │   └── yarn.lock
</span></span><span class=line><span class=cl>│   └── src
</span></span><span class=line><span class=cl>│       └── main.rs
</span></span><span class=line><span class=cl>└── framework-solve
</span></span><span class=line><span class=cl>    ├── Cargo.lock
</span></span><span class=line><span class=cl>    ├── Cargo.toml
</span></span><span class=line><span class=cl>    ├── build_solution.sh
</span></span><span class=line><span class=cl>    ├── solve
</span></span><span class=line><span class=cl>    │   ├── Anchor.toml
</span></span><span class=line><span class=cl>    │   ├── Cargo.lock
</span></span><span class=line><span class=cl>    │   ├── Cargo.toml
</span></span><span class=line><span class=cl>    │   ├── migrations
</span></span><span class=line><span class=cl>    │   │   └── deploy.ts
</span></span><span class=line><span class=cl>    │   ├── package.json
</span></span><span class=line><span class=cl>    │   ├── programs
</span></span><span class=line><span class=cl>    │   │   └── solve
</span></span><span class=line><span class=cl>    │   │       ├── Cargo.toml
</span></span><span class=line><span class=cl>    │   │       ├── Xargo.toml
</span></span><span class=line><span class=cl>    │   │       └── src
</span></span><span class=line><span class=cl>    │   │           └── lib.rs
</span></span><span class=line><span class=cl>    │   ├── tests
</span></span><span class=line><span class=cl>    │   │   └── solve.ts
</span></span><span class=line><span class=cl>    │   ├── tsconfig.json
</span></span><span class=line><span class=cl>    │   └── yarn.lock
</span></span><span class=line><span class=cl>    └── src
</span></span><span class=line><span class=cl>        └── main.rs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>17</span> directories, <span class=m>32</span> files
</span></span></code></pre></td></tr></table></div></div><p>After reading the README.md, we are aware that we should</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Use `framework/` to locally setup the challenge
</span></span><span class=line><span class=cl>Use `framework-solve/` to solve the challenge locally and remotely
</span></span></code></pre></td></tr></table></div></div><p>First, we take a look at the framework folder.</p><p>If we take a look at framework/src/main.rs, we can see</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>use</span><span class=w> </span><span class=n>chall</span>::<span class=n>Play</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>chall</span>::<span class=n>anchor_lang</span>::<span class=n>InstructionData</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>chall</span>::<span class=n>anchor_lang</span>::<span class=n>ToAccountMetas</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>env</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>io</span>::<span class=n>Write</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>sol_ctf_framework</span>::<span class=n>ChallengeBuilder</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>solana_sdk</span>::<span class=n>compute_budget</span>::<span class=n>ComputeBudgetInstruction</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>solana_program</span>::<span class=n>instruction</span>::<span class=n>Instruction</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>solana_program</span>::<span class=n>system_instruction</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>solana_program_test</span>::<span class=n>tokio</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>solana_sdk</span>::<span class=n>pubkey</span>::<span class=n>Pubkey</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>solana_sdk</span>::<span class=n>signature</span>::<span class=n>Signer</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>solana_sdk</span>::<span class=n>signer</span>::<span class=n>keypair</span>::<span class=n>Keypair</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>error</span>::<span class=n>Error</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>net</span>::<span class=p>{</span><span class=n>TcpListener</span><span class=p>,</span><span class=w> </span><span class=n>TcpStream</span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>#[tokio::main]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=p>(),</span><span class=w> </span><span class=nb>Box</span><span class=o>&lt;</span><span class=k>dyn</span><span class=w> </span><span class=n>Error</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>listener</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>TcpListener</span>::<span class=n>bind</span><span class=p>(</span><span class=s>&#34;0.0.0.0:1337&#34;</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;starting server at port 1337!&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=n>stream</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>listener</span><span class=p>.</span><span class=n>incoming</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>stream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stream</span><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>tokio</span>::<span class=n>spawn</span><span class=p>(</span><span class=k>async</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Err</span><span class=p>(</span><span class=n>err</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>handle_connection</span><span class=p>(</span><span class=n>stream</span><span class=p>).</span><span class=k>await</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;error: </span><span class=si>{:?}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>err</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>handle_connection</span><span class=p>(</span><span class=k>mut</span><span class=w> </span><span class=n>socket</span>: <span class=nc>TcpStream</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=p>(),</span><span class=w> </span><span class=nb>Box</span><span class=o>&lt;</span><span class=k>dyn</span><span class=w> </span><span class=n>Error</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>builder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ChallengeBuilder</span>::<span class=n>try_from</span><span class=p>(</span><span class=n>socket</span><span class=p>.</span><span class=n>try_clone</span><span class=p>().</span><span class=n>unwrap</span><span class=p>()).</span><span class=n>unwrap</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>chall_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=n>add_program</span><span class=p>(</span><span class=s>&#34;./chall/target/deploy/chall.so&#34;</span><span class=p>,</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=n>chall</span>::<span class=no>ID</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>solve_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=n>input_program</span><span class=p>()</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>chall</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=n>build</span><span class=p>().</span><span class=k>await</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// -------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=c1>// [setup env] initialize
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=c1>// -------------------------------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>program_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// admin has infinite money wauw
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>admin_keypair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall</span><span class=p>.</span><span class=n>ctx</span><span class=p>.</span><span class=n>payer</span><span class=p>.</span><span class=n>insecure_clone</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>admin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>admin_keypair</span><span class=p>.</span><span class=n>pubkey</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>db</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Pubkey</span>::<span class=n>find_program_address</span><span class=p>(</span><span class=o>&amp;</span><span class=p>[</span><span class=w> </span><span class=sa>b</span><span class=s>&#34;wysi&#34;</span><span class=w> </span><span class=p>],</span><span class=w> </span><span class=o>&amp;</span><span class=n>program_id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>player_keypair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Keypair</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>player</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>player_keypair</span><span class=p>.</span><span class=n>pubkey</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>cookiezi_keypair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Keypair</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>cookiezi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cookiezi_keypair</span><span class=p>.</span><span class=n>pubkey</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>chall</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>run_ix</span><span class=p>(</span><span class=n>system_instruction</span>::<span class=n>transfer</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&amp;</span><span class=n>admin</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&amp;</span><span class=n>cookiezi</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=mi>500_000_000_000_000</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=k>await</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ur poor :^c
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>chall</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>run_ix</span><span class=p>(</span><span class=n>system_instruction</span>::<span class=n>transfer</span><span class=p>(</span><span class=o>&amp;</span><span class=n>admin</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=n>player</span><span class=p>,</span><span class=w> </span><span class=mi>100_000_000</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=k>await</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\n</span><span class=s>Non-PDA Accounts created...</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>ix</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall</span>::<span class=n>instruction</span>::<span class=n>InitDb</span><span class=w> </span><span class=p>{};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>ix_accounts</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall</span>::<span class=n>accounts</span>::<span class=n>InitDb</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>db</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>user</span>: <span class=nc>admin</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>system_program</span>: <span class=nc>solana_program</span>::<span class=n>system_program</span>::<span class=no>ID</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>rent</span>: <span class=nc>solana_program</span>::<span class=n>sysvar</span>::<span class=n>rent</span>::<span class=no>ID</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>chall</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>run_ixs_full</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&amp;</span><span class=p>[</span><span class=n>Instruction</span>::<span class=n>new_with_bytes</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>program_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=o>&amp;</span><span class=n>ix</span><span class=p>.</span><span class=n>data</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ix_accounts</span><span class=p>.</span><span class=n>to_account_metas</span><span class=p>(</span><span class=nb>None</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&amp;</span><span class=p>[</span><span class=o>&amp;</span><span class=n>admin_keypair</span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&amp;</span><span class=n>admin</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>).</span><span class=k>await</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>ix</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall</span>::<span class=n>instruction</span>::<span class=n>SubmitPlay</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>play</span>: <span class=nc>Play</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>map</span>: <span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;blue zenith&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>player</span>: <span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;chocomint&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>pp</span>: <span class=mi>727</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>bounty</span>: <span class=mi>1_000_000_000_000</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>ix_accounts</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall</span>::<span class=n>accounts</span>::<span class=n>SubmitPlay</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>db</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>player</span>: <span class=nc>cookiezi</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>system_program</span>: <span class=nc>solana_program</span>::<span class=n>system_program</span>::<span class=no>ID</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>chall</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>run_ixs_full</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&amp;</span><span class=p>[</span><span class=n>Instruction</span>::<span class=n>new_with_bytes</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>program_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=o>&amp;</span><span class=n>ix</span><span class=p>.</span><span class=n>data</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ix_accounts</span><span class=p>.</span><span class=n>to_account_metas</span><span class=p>(</span><span class=nb>None</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&amp;</span><span class=p>[</span><span class=o>&amp;</span><span class=n>cookiezi_keypair</span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&amp;</span><span class=n>cookiezi</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>).</span><span class=k>await</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>writeln!</span><span class=p>(</span><span class=n>socket</span><span class=p>,</span><span class=w> </span><span class=s>&#34;player: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>player</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>writeln!</span><span class=p>(</span><span class=n>socket</span><span class=p>,</span><span class=w> </span><span class=s>&#34;db: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>db</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// snipe shige :^)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>bump_budget</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ComputeBudgetInstruction</span>::<span class=n>set_compute_unit_limit</span><span class=p>(</span><span class=mi>10_000_000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>solve_ix</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall</span><span class=p>.</span><span class=n>read_instruction</span><span class=p>(</span><span class=n>solve_id</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>chall</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=n>run_ixs_full</span><span class=p>(</span><span class=o>&amp;</span><span class=p>[</span><span class=n>bump_budget</span><span class=p>,</span><span class=w> </span><span class=n>solve_ix</span><span class=p>],</span><span class=w> </span><span class=o>&amp;</span><span class=p>[</span><span class=o>&amp;</span><span class=n>player_keypair</span><span class=p>],</span><span class=w> </span><span class=o>&amp;</span><span class=n>player</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=k>await</span><span class=p>.</span><span class=n>ok</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>player_account</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall</span><span class=p>.</span><span class=n>ctx</span><span class=p>.</span><span class=n>banks_client</span><span class=p>.</span><span class=n>get_account</span><span class=p>(</span><span class=n>player</span><span class=p>).</span><span class=k>await</span><span class=o>?</span><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=n>player_account</span><span class=p>.</span><span class=n>lamports</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>500_000_000_000</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>writeln!</span><span class=p>(</span><span class=n>socket</span><span class=p>,</span><span class=w> </span><span class=s>&#34;congrats!&#34;</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Ok</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>env</span>::<span class=n>var</span><span class=p>(</span><span class=s>&#34;FLAG&#34;</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=fm>writeln!</span><span class=p>(</span><span class=n>socket</span><span class=p>,</span><span class=w> </span><span class=s>&#34;flag: {:?}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>flag</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=fm>writeln!</span><span class=p>(</span><span class=n>socket</span><span class=p>,</span><span class=w> </span><span class=s>&#34;flag not found, please contact admin&#34;</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=fm>writeln!</span><span class=p>(</span><span class=n>socket</span><span class=p>,</span><span class=w> </span><span class=s>&#34;shige lives to see another day&#34;</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>In the above, we can see two things that happen</p><ol><li>an initial setup where player &ldquo;cookiezi&rdquo; is given a large sum of money.</li><li>the server then processes a &ldquo;SubmitPlay&rdquo; instruction, which allows for the submission of a play that meets specific bounty amount</li></ol><p>from looking at the above code,we are aware that we can exploit the <code>SubmitPlay</code>, as it doesn&rsquo;t properly validate the required conditions where bounty payout should happen, and doesn&rsquo;t make sure that the play submitted meets specific criteria beyond the control of the submitting player</p><p>We can write our solution code inside the provided <code>initialize</code> function in the <code>framework-solve/solve/programs/solve/src/lib.rs</code> file that is specifically for writing the solution code, where we have:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>use</span><span class=w> </span><span class=n>anchor_lang</span>::<span class=n>prelude</span>::<span class=o>*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>chall</span>::<span class=n>Play</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=fm>declare_id!</span><span class=p>(</span><span class=s>&#34;28prS7e14Fsm97GE5ws2YpjxseFNkiA33tB5D3hLZv3t&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>#[program]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>pub</span><span class=w> </span><span class=k>mod</span> <span class=nn>solve</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=k>super</span>::<span class=o>*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=k>fn</span> <span class=nf>initialize</span><span class=p>(</span><span class=n>ctx</span>: <span class=nc>Context</span><span class=o>&lt;</span><span class=n>Initialize</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>cpi_accounts</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall</span>::<span class=n>cpi</span>::<span class=n>accounts</span>::<span class=n>SubmitPlay</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>db</span>: <span class=nc>ctx</span><span class=p>.</span><span class=n>accounts</span><span class=p>.</span><span class=n>db</span><span class=p>.</span><span class=n>to_account_info</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>player</span>: <span class=nc>ctx</span><span class=p>.</span><span class=n>accounts</span><span class=p>.</span><span class=n>user</span><span class=p>.</span><span class=n>to_account_info</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>system_program</span>: <span class=nc>ctx</span><span class=p>.</span><span class=n>accounts</span><span class=p>.</span><span class=n>system_program</span><span class=p>.</span><span class=n>to_account_info</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>play</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Play</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// i think the map name is blue zenith
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>            </span><span class=n>map</span>: <span class=s>&#34;blue zenith&#34;</span><span class=p>.</span><span class=n>to_string</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>player</span>: <span class=s>&#34;chocomint&#34;</span><span class=p>.</span><span class=n>to_string</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>pp</span>: <span class=mi>728</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>bounty</span>: <span class=mi>1</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>cpi_program</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ctx</span><span class=p>.</span><span class=n>accounts</span><span class=p>.</span><span class=n>chall</span><span class=p>.</span><span class=n>to_account_info</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>cpi_ctx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CpiContext</span>::<span class=n>new</span><span class=p>(</span><span class=n>cpi_program</span><span class=p>,</span><span class=w> </span><span class=n>cpi_accounts</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>chall</span>::<span class=n>cpi</span>::<span class=n>submit_play</span><span class=p>(</span><span class=n>cpi_ctx</span><span class=p>,</span><span class=w> </span><span class=n>play</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nb>Ok</span><span class=p>(())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>#[derive(Accounts)]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>pub</span><span class=w> </span><span class=k>struct</span> <span class=nc>Initialize</span><span class=o>&lt;</span><span class=na>&#39;info</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// feel free to expand/change this as needed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=c1>// if you change this, make sure to change framework-solve/src/main.rs accordingly
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=cp>#[account(mut)]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=n>user</span>: <span class=nc>Signer</span><span class=o>&lt;</span><span class=na>&#39;info</span><span class=o>&gt;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=cp>#[account(mut)]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=n>db</span>: <span class=nc>AccountInfo</span><span class=o>&lt;</span><span class=na>&#39;info</span><span class=o>&gt;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=n>chall</span>: <span class=nc>Program</span><span class=o>&lt;</span><span class=na>&#39;info</span><span class=p>,</span><span class=w> </span><span class=n>chall</span>::<span class=n>program</span>::<span class=n>Chall</span><span class=o>&gt;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=n>system_program</span>: <span class=nc>Program</span><span class=o>&lt;</span><span class=na>&#39;info</span><span class=p>,</span><span class=w> </span><span class=n>System</span><span class=o>&gt;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>pub</span><span class=w> </span><span class=n>rent</span>: <span class=nc>Sysvar</span><span class=o>&lt;</span><span class=na>&#39;info</span><span class=p>,</span><span class=w> </span><span class=n>Rent</span><span class=o>&gt;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Looking closely, this is the specific code we wrote</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>pub</span><span class=w> </span><span class=k>fn</span> <span class=nf>initialize</span><span class=p>(</span><span class=n>ctx</span>: <span class=nc>Context</span><span class=o>&lt;</span><span class=n>Initialize</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>cpi_accounts</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chall</span>::<span class=n>cpi</span>::<span class=n>accounts</span>::<span class=n>SubmitPlay</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>db</span>: <span class=nc>ctx</span><span class=p>.</span><span class=n>accounts</span><span class=p>.</span><span class=n>db</span><span class=p>.</span><span class=n>to_account_info</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>player</span>: <span class=nc>ctx</span><span class=p>.</span><span class=n>accounts</span><span class=p>.</span><span class=n>user</span><span class=p>.</span><span class=n>to_account_info</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>system_program</span>: <span class=nc>ctx</span><span class=p>.</span><span class=n>accounts</span><span class=p>.</span><span class=n>system_program</span><span class=p>.</span><span class=n>to_account_info</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>play</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Play</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// the map name is blue zenith
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>            </span><span class=n>map</span>: <span class=s>&#34;blue zenith&#34;</span><span class=p>.</span><span class=n>to_string</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>player</span>: <span class=s>&#34;chocomint&#34;</span><span class=p>.</span><span class=n>to_string</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>pp</span>: <span class=mi>728</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>bounty</span>: <span class=mi>1</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>cpi_program</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ctx</span><span class=p>.</span><span class=n>accounts</span><span class=p>.</span><span class=n>chall</span><span class=p>.</span><span class=n>to_account_info</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>cpi_ctx</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CpiContext</span>::<span class=n>new</span><span class=p>(</span><span class=n>cpi_program</span><span class=p>,</span><span class=w> </span><span class=n>cpi_accounts</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>chall</span>::<span class=n>cpi</span>::<span class=n>submit_play</span><span class=p>(</span><span class=n>cpi_ctx</span><span class=p>,</span><span class=w> </span><span class=n>play</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nb>Ok</span><span class=p>(())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>And this works, as we can verify this locally
<img src=/p/osugamingctf-2024/img/image.png width=1216 height=272 srcset="/p/osugamingctf-2024/img/image_huaaa69a2afa7db84157a34d5ce4579652_81427_480x0_resize_box_3.png 480w, /p/osugamingctf-2024/img/image_huaaa69a2afa7db84157a34d5ce4579652_81427_1024x0_resize_box_3.png 1024w" loading=lazy alt="solved locally" class=gallery-image data-flex-grow=447 data-flex-basis=1072px></p><p>And after changing in <code>framework-solve/src/main.rs</code> to nc to the challenge server</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=p>(),</span><span class=w> </span><span class=nb>Box</span><span class=o>&lt;</span><span class=k>dyn</span><span class=w> </span><span class=n>Error</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>stream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>TcpStream</span>::<span class=n>connect</span><span class=p>(</span><span class=s>&#34;chal2.osugaming.lol:8000&#34;</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>reader</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>BufReader</span>::<span class=n>new</span><span class=p>(</span><span class=n>stream</span><span class=p>.</span><span class=n>try_clone</span><span class=p>().</span><span class=n>unwrap</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>line</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>String</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>so_data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fs</span>::<span class=n>read</span><span class=p>(</span><span class=s>&#34;./solve/target/deploy/solve.so&#34;</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><img src=/p/osugamingctf-2024/img/image-2.png width=1574 height=520 srcset="/p/osugamingctf-2024/img/image-2_hueaac074a2363e56a7deebd670c4064ad_244661_480x0_resize_box_3.png 480w, /p/osugamingctf-2024/img/image-2_hueaac074a2363e56a7deebd670c4064ad_244661_1024x0_resize_box_3.png 1024w" loading=lazy alt="actual flag" class=gallery-image data-flex-grow=302 data-flex-basis=726px></p><p>We are able to run the solve script again and we get the flag <code>osu{blud_think_he_mrekk}</code>.</p><h3 id=reversesat-before-osu>reverse/SAT-before-osu</h3><blockquote><p>My mom won’t let me play osu if I don’t study for the SAT but this looks nothing like it! Please help me! T^T<br>— <cite>BrokenAppendix</cite></p></blockquote><p>In this challenge, we&rsquo;re given the below system of equations that I&rsquo;ve put into <code>constraints</code>. This is a set of systems and equations that can be easily solved with the z3 theorem prover.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>z3</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>h</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>l</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>o</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>t</span><span class=p>,</span> <span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>x</span> <span class=o>=</span> <span class=n>Ints</span><span class=p>(</span><span class=s1>&#39;a b c d e f g h i j k l m n o p q r s t u v w x&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>constraints</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>+</span> <span class=n>c</span> <span class=o>+</span> <span class=n>w</span> <span class=o>==</span> <span class=mi>314</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>+</span> <span class=n>d</span> <span class=o>+</span> <span class=n>u</span> <span class=o>==</span> <span class=mi>290</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>+</span> <span class=n>w</span> <span class=o>+</span> <span class=n>e</span> <span class=o>==</span> <span class=mi>251</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>+</span> <span class=n>l</span> <span class=o>+</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>274</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>+</span> <span class=n>t</span> <span class=o>+</span> <span class=n>b</span> <span class=o>==</span> <span class=mi>344</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>m</span> <span class=o>==</span> <span class=mi>255</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span> <span class=o>+</span> <span class=n>o</span> <span class=o>+</span> <span class=n>u</span> <span class=o>==</span> <span class=mi>253</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>+</span> <span class=n>l</span> <span class=o>+</span> <span class=n>o</span> <span class=o>==</span> <span class=mi>316</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>+</span> <span class=n>g</span> <span class=o>+</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>252</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>+</span> <span class=n>x</span> <span class=o>+</span> <span class=n>q</span> <span class=o>==</span> <span class=mi>315</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>+</span> <span class=n>n</span> <span class=o>+</span> <span class=n>m</span> <span class=o>==</span> <span class=mi>302</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>+</span> <span class=n>b</span> <span class=o>+</span> <span class=n>g</span> <span class=o>==</span> <span class=mi>328</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>e</span> <span class=o>+</span> <span class=n>o</span> <span class=o>+</span> <span class=n>m</span> <span class=o>==</span> <span class=mi>246</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>v</span> <span class=o>+</span> <span class=n>v</span> <span class=o>+</span> <span class=n>u</span> <span class=o>==</span> <span class=mi>271</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>+</span> <span class=n>o</span> <span class=o>+</span> <span class=n>q</span> <span class=o>==</span> <span class=mi>318</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>+</span> <span class=n>o</span> <span class=o>+</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>212</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>j</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>197</span><span class=p>,</span>  
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>+</span> <span class=n>u</span> <span class=o>+</span> <span class=n>l</span> <span class=o>==</span> <span class=mi>213</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>+</span> <span class=n>w</span> <span class=o>+</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>228</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>+</span> <span class=n>d</span> <span class=o>+</span> <span class=n>r</span> <span class=o>==</span> <span class=mi>350</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>e</span> <span class=o>+</span> <span class=n>k</span> <span class=o>+</span> <span class=n>u</span> <span class=o>==</span> <span class=mi>177</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span> <span class=o>+</span> <span class=n>n</span> <span class=o>+</span> <span class=n>a</span> <span class=o>==</span> <span class=mi>288</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>+</span> <span class=n>e</span> <span class=o>+</span> <span class=n>u</span> <span class=o>==</span> <span class=mi>212</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>q</span> <span class=o>+</span> <span class=n>l</span> <span class=o>+</span> <span class=n>f</span> <span class=o>==</span> <span class=mi>321</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>solver</span> <span class=o>=</span> <span class=n>Solver</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>solver</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>constraints</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>solver</span><span class=o>.</span><span class=n>check</span><span class=p>()</span> <span class=o>==</span> <span class=n>sat</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solution</span> <span class=o>=</span> <span class=n>solver</span><span class=o>.</span><span class=n>model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># convert from number decimal to ascii</span>
</span></span><span class=line><span class=cl>    <span class=n>ascii_output</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>solution</span><span class=p>[</span><span class=n>variable</span><span class=p>]</span><span class=o>.</span><span class=n>as_long</span><span class=p>())</span> <span class=k>for</span> <span class=n>variable</span> <span class=ow>in</span> <span class=p>[</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>g</span><span class=p>,</span> <span class=n>h</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>k</span><span class=p>,</span> <span class=n>l</span><span class=p>,</span> <span class=n>m</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>o</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>q</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>s</span><span class=p>,</span> <span class=n>t</span><span class=p>,</span> <span class=n>u</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>x</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>ascii_output</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>The flag that we get is <code>osu{0rZ_p3PpY_my_s4v1oR}</code></p><h3 id=cryptobase727>crypto/base727</h3><p><img src=/p/osugamingctf-2024/img/crypto-base727.png width=1196 height=1046 srcset="/p/osugamingctf-2024/img/crypto-base727_hu79269fdb77ea9e13ce9763857fb24a80_255122_480x0_resize_box_3.png 480w, /p/osugamingctf-2024/img/crypto-base727_hu79269fdb77ea9e13ce9763857fb24a80_255122_1024x0_resize_box_3.png 1024w" loading=lazy alt="crypto/base727 challenge" class=gallery-image data-flex-grow=114 data-flex-basis=274px></p><p>We’re given the file <a class=link href=727.py>727.py</a> along with the encoded flag <code>06c3abc49dc4b443ca9d65c8b0c386c4b0c99fc798c2bdc5bccb94c68c37c296ca9ac29ac790c4af7bc585c59d</code>.</p><p>To decrypt, we write a script that is able to decode from a base727 encoded string to text, and decrypt the encoded flag:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>binascii</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decode_base_727</span><span class=p>(</span><span class=n>encoded_hex</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>encoded_bytes</span> <span class=o>=</span> <span class=n>binascii</span><span class=o>.</span><span class=n>unhexlify</span><span class=p>(</span><span class=n>encoded_hex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>encoded_string</span> <span class=o>=</span> <span class=n>encoded_bytes</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>base</span> <span class=o>=</span> <span class=mi>727</span>
</span></span><span class=line><span class=cl>    <span class=n>decoded_value</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>encoded_string</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>decoded_value</span> <span class=o>=</span> <span class=n>decoded_value</span> <span class=o>*</span> <span class=n>base</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=n>char</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>original_string</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>decoded_value</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>original_string</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>decoded_value</span> <span class=o>%</span> <span class=mi>256</span><span class=p>)</span> <span class=o>+</span> <span class=n>original_string</span>
</span></span><span class=line><span class=cl>        <span class=n>decoded_value</span> <span class=o>//=</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>original_string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>encoded_hex</span> <span class=o>=</span> <span class=s2>&#34;06c3abc49dc4b443ca9d65c8b0c386c4b0c99fc798c2bdc5bccb94c68c37c296ca9ac29ac790c4af7bc585c59d&#34;</span>  
</span></span><span class=line><span class=cl><span class=n>original_string</span> <span class=o>=</span> <span class=n>decode_base_727</span><span class=p>(</span><span class=n>encoded_hex</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>original_string</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>And we get the flag <code>osu{wysiwysiwysiywsywiwywsi}</code></p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><div class=disqus-container></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2026 Rose's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>